<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/home.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/js/all.min.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home | Dizcuss</title>
</head>

<body>
    <%- include('sidebar', { currentPage: 'Home' }) %>
        <div class="home-container">
            <section id="create-discussion">
                <form id="discussion-form">

                    <label for="content">What's happening?</label>
                    <textarea id="content" class="content-input" name="content" rows="4" cols="50"
                        placeholder="Ask a question?" required></textarea><br>

                    <button type="submit" class="submit-button">Create Discussion</button>
                </form>
            </section>

            <div id="discussions">
                <% discussions.forEach(discussion=> { %>
                    <div>
                        <p class="user-name">
                            @<%= discussion.user.username %>
                        </p>
                        <p>
                            <%= discussion.content %>
                        </p>
                        <button class="reply-button" data-id="<%= discussion._id %>">Reply</button>
                        <button class="like-discussion-button" data-id="<%= discussion._id %>">
                            <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                            <span class="count">
                                <%= discussion.likes %>
                            </span> Likes
                        </button>
                        <button class="dislike-discussion-button" data-id="<%= discussion._id %>">
                            <i class="fa fa-thumbs-down" aria-hidden="true"></i>
                            <%= discussion.dislikes %> Dislikes
                        </button>
                        <button class="delete-discussion-button" data-id="<%= discussion._id %>">Delete</button>
                    </div>
                    <div>
                        <% discussion.replies.forEach(reply=> { %>
                            <div>
                                <p>
                                    <%= reply.user.username %>
                                </p>
                                <p>
                                    <%= reply.content %>
                                </p>
                                <button class="like-button" data-id="<%= reply._id %>">Like (<%= reply.likes %>
                                        )</button>
                                <button class="dislike-button" data-id="<%= reply._id %>">Dislike (<%= reply.dislikes %>
                                        )</button>
                            </div>
                            <% }); %>
                    </div>
                    <% }); %>
            </div>

            <div id="myModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Add Reply</h2>
                    <textarea id="replyContent" rows="4" cols="50"></textarea>
                    <button id="submitReply">Submit</button>
                </div>
            </div>
        </div>
        
        <div id="popup" class="popup" style="display: none;">
            <div class="popup-content">
                <span class="close-popup">&times;</span>
                <h2>Discussion</h2>
                <div id="discussion-popup">
                    <!-- Discussion content goes here -->
                </div>
                <h2>Replies</h2>
                <div id="replies-popup">
                    <!-- Replies content goes here -->
                </div>
                <!-- Add other content here -->
            </div>
        </div>
        <script type="text/javascript" src="../assets/js/app.js"></script>
</body>

</html>